<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Install in an AWS EKS Cluster :: Nuvolaris</title>
    <link rel="canonical" href="https://nuvolaris.github.io/nuvolaris/0.2.2/how-to-install-on-aws-eks.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../assets/css/site.css">
    <script>var uiRootPath = '../../assets'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://nuvolaris.github.io">Nuvolaris</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="nuvolaris" data-version="0.2.2">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Nuvolaris</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="installation.html">Installation Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="how-to-install-on-docker-desktop.html">Install on Docker Desktop</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="how-to-install-on-aws-ec2.html">Install on a single instance on AWS EC2 Instance</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="how-to-install-on-hetzner-cloud.html">Install on a single instance on Hetzner Cloud</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="how-to-install-on-aws-eks.html">Install on an AWS EKS Cluster</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="how-to-install-on-ubuntu.html">Install on a generic Ubuntu Instance</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="how-to-install-on-kubernetes.html">Install on a Kubernetes Cluster</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Nuvolaris</span>
    <span class="version">0.2.2</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../0.3.0/index.html">Nuvolaris</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../0.3.0/index.html">0.3.0</a>
        </li>
        <li class="version is-current">
          <a href="index.html">0.2.2</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../0.3.0/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Nuvolaris</a></li>
    <li><a href="how-to-install-on-aws-eks.html">Install on an AWS EKS Cluster</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">0.2.2</button>
  <div class="version-menu">
    <a class="version is-missing" href="../0.3.0/index.html">0.3.0</a>
    <a class="version is-current" href="how-to-install-on-aws-eks.html">0.2.2</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/nuvolaris/nuvolaris-documentation/edit/0.2.2/modules/ROOT/pages/how-to-install-on-aws-eks.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Install in an AWS EKS Cluster</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Before starting this guide you need an account in AWS and <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html">configure CLI access</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_an_aws_eks_cluster"><a class="anchor" href="#_create_an_aws_eks_cluster"></a>Create an AWS EKS cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you do not have already an EKS cluster for installing Nuvolaris, you need to create one. There are many ways to create an EKS cluster. In this guide we recommend using the <a href="httsp://eksctl.io"><code>eksctl</code></a> tool.</p>
</div>
<div class="paragraph">
<p>Start <a href="https://docs.aws.amazon.com/eks/latest/userguide/eksctl.html">following this guide</a> to install it.</p>
</div>
<div class="paragraph">
<p>Once you have it installed, you need to launch an instance with at least one worker node with at least 4GB of memory.</p>
</div>
<div class="paragraph">
<p>Also the cluster needs to have the EBS block storage plugin enabled.</p>
</div>
<div class="paragraph">
<p>You can adapt this <code>eksctl</code> configuration file to create a suitable cluster for Nuvolaris:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>apiVersion: eksctl.io/v1alpha5
kind: ClusterConfig

metadata:
  name: nuvolaris-cluster
  region: eu-central-1

iam:
  withOIDC: true

nodeGroups:
  - name: ng-1
    instanceType: m5.large
    desiredCapacity: 1
    volumeSize: 80
    ssh:
      publicKeyPath: id_rsa.pub
    iam:
      withAddonPolicies:
        ebs: true
addons:
  - name: aws-ebs-csi-driver</pre>
</div>
</div>
<div class="paragraph">
<p>Note it is using here (and you should adapt to your needs):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the region <code>eu-central-1</code>, you can pick one closer to you</p>
</li>
<li>
<p>instances of type <code>m5.large</code>, you can pick a different type</p>
</li>
<li>
<p>the <code>desideredCapacity</code> is of only 1 worker node, you can add more</p>
</li>
<li>
<p>the <code>volumeSize</code> is of 80 GB, pick your size</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Copy and edit the configuration file as <code>eks-cluster.yaml</code>.</p>
</div>
<div class="paragraph">
<p>Then you launch the actual cluster creation with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>eksctl create cluster -f eks-cluster.yml</pre>
</div>
</div>
<div class="paragraph">
<p>It will take a while. Once the cluster is created you can retrieve the configuration to access it and check if the access works with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>eksctl utils write-kubeconfig --cluster=nuvolaris-cluster
kubectl get nodes</pre>
</div>
</div>
<div class="paragraph">
<p>You should see something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>NAME                                              STATUS   ROLES    AGE   VERSION
ip-192-168-42-140.eu-central-1.compute.internal   Ready    &lt;none&gt;   34d   v1.22.6-eks-7d68063</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_retrieve_your_kubernetes_context"><a class="anchor" href="#_retrieve_your_kubernetes_context"></a>Retrieve your Kubernetes context</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you installed Kubernetes following the instructions of your cloud provider, it will be accessible with the <code>kubectl</code> tool.</p>
</div>
<div class="paragraph">
<p>You can generally have more contexts to access multiple Kubernetes at the same time. Each Kubernetes is a different context. You can see the available contexts with the command <code>kubectl config get-contexts</code>.</p>
</div>
<div class="paragraph">
<p>Pick the name of the <code>&lt;kubernetes-context&gt;</code> corresponding to the cluster you want to install Nuvolaris.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installing_nuvolaris_with_nuv"><a class="anchor" href="#_installing_nuvolaris_with_nuv"></a>Installing Nuvolaris with <code>nuv</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now you are ready to install Nuvolaris.</p>
</div>
<div class="paragraph">
<p>Copy the <code>&lt;url-address&gt;</code> of the latest version of the installer <a href="https://github.com/nuvolaris/nuvolaris/releases">from this page</a>.</p>
</div>
<div class="paragraph">
<p>Then download and unpack it (replace <code>&lt;url-address&gt;</code> with the actual URL address):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -sL &lt;url-address&gt; | tar xzvf -
install nuv /usr/local/bin/nuv
nuv -v</pre>
</div>
</div>
<div class="paragraph">
<p>If the download went ok, you should see the version number of the installer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>nuv setup --context=&lt;kubernetes-context&gt; --apihost=auto</pre>
</div>
</div>
<div class="paragraph">
<p>The installation can take a few minutes to complete, mostly because a number of large Docker images must be downloaded. If you are curious, you can check what is happening on the Kubernetes cluster running (in another terminal) the command <code>watch kubectl get po,svc</code>.</p>
</div>
<div class="sect2">
<h3 id="_accessing_the_serverless_environment_remotely"><a class="anchor" href="#_accessing_the_serverless_environment_remotely"></a>Accessing the serverless environment remotely</h3>
<div class="paragraph">
<p>Now that your serverless environemnt is ready you can access it from anywhere, using the configured <code>apihost</code> and <code>auth</code> key.</p>
</div>
<div class="paragraph">
<p>Type <code>nuv wsk property get</code>. It will show something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>whisk API host		&lt;apihost&gt;
whisk auth		    &lt;auth&gt;
whisk namespace		nuvolaris
whisk API version	v1
whisk CLI version	v0.2.0-trinity.22061015
whisk API build		2021-12-29T12:28:02+0000
whisk API build number	67b3e50</pre>
</div>
</div>
<div class="paragraph">
<p>Take note of the values <code>&lt;apihost&gt;</code> and <code>&lt;auth&gt;</code> as you wil need it to access your serverless environment remotely.</p>
</div>
<div class="paragraph">
<p>Now you can <a href="https://github.com/nuvolaris/nuvolaris/releases">download</a> the <code>nuv</code> tool elsewhere, and connect to your serverless environment with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>nuv wskprops --apihost=&lt;apihost&gt; --auth=&lt;auth&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Once the installation is completed, proceed reading <a href="https://openwhisk.apache.org/documentation.html">Apache OpenWhisk documentation</a>, remembering to use <code>nuv wsk</code> when you see <code>wsk</code>.</p>
</div>
<div class="paragraph">
<p>If something goes wrong, please check the <a href="troubleshooting.html" class="xref page">troubleshooting</a> page.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../assets/js/site.js" data-ui-root-path="../../assets"></script>
<script async src="../../assets/js/vendor/highlight.js"></script>
  </body>
</html>
